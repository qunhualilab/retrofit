* Checking package dependencies... OK
* Checking if other packages can import this one... OK
* Checking to see if we understand object initialization...
* NOTE: Consider clarifying how 1 object(s) are initialized. Maybe it is part of a data set loaded with data(), or perhaps part of an object referenced in with() or within().
function (object)
annotateWithCorrelations (r)
* Checking for deprecated package usage... OK
* Checking for remote package usage... OK
* Checking for 'LazyData: true' usage... OK
* Checking version number... OK
* Checking version number validity... OK
* Checking R version dependency... OK
* Checking package size... OK
* Checking individual file sizes...
* WARNING: The following files are over 5MB in size: '.git/objects/pack/pack-53389786c8b914e890257465f6a8f1f0f8fcb0e6.pack'
* Checking biocViews... OK
* Checking that biocViews are present... OK
* Checking package type based on biocViews... OK
* Checking for non-trivial biocViews... OK
* Checking that biocViews come from the same category... OK
* Checking biocViews validity... OK
* Checking for recommended biocViews... OK
* Checking build system compatibility... OK
* Checking for blank lines in DESCRIPTION... OK
* Checking if DESCRIPTION is well formatted... OK
* Checking for proper Description: field... OK
* Checking for whitespace in DESCRIPTION field names... OK
* Checking that Package field matches directory/tarball name... OK
* Checking for Version field... OK
* Checking for valid maintainer... OK
* Checking License: for restrictive use... OK
* Checking for pinned package versions... OK
* Checking DESCRIPTION/NAMESPACE consistency... OK
* Checking .Rbuildignore... OK
* Checking for stray BiocCheck output folders... OK
* Checking vignette directory... OK
* Checking package installation calls in R code... OK
* Checking for library/require of retrofit... OK
* Checking coding practice...
* NOTE:  Avoid 1:...; use seq_len() or seq_along()
Found in files:
annotateWithCorrelations.R (line 46, column 40)
annotateWithCorrelations.R (line 68, column 13)
annotateWithCorrelations.R (line 80, column 13)
annotateWithCorrelations.R (line 93, column 12)
annotateWithCorrelations.R (line 117, column 13)
annotateWithCorrelations.R (line 128, column 12)
annotateWithCorrelations.R (line 132, column 12)
annotateWithMarkers.R (line 67, column 13)
annotateWithMarkers.R (line 73, column 12)
annotateWithMarkers.R (line 78, column 14)
annotateWithMarkers.R (line 90, column 12)
annotateWithMarkers.R (line 112, column 13)
annotateWithMarkers.R (line 123, column 12)
annotateWithMarkers.R (line 127, column 12)
* NOTE:  Avoid 'cat' and 'print' outside of 'show' methods
Found in files:
print() in R/decompose.R (line 191, column 7)
print() in R/decompose.R (line 206, column 5)
* NOTE:  Avoid using '=' for assignment and use '<-' instead
Found in files:
R/annotateWithCorrelations.R (line  42, column 14)
R/annotateWithCorrelations.R (line  45, column 16)
R/annotateWithCorrelations.R (line  46, column 16)
R/annotateWithCorrelations.R (line  50, column  7)
R/annotateWithCorrelations.R (line  54, column  7)
R/annotateWithCorrelations.R (line  58, column  5)
R/annotateWithCorrelations.R (line  59, column  5)
R/annotateWithCorrelations.R (line  60, column 15)
R/annotateWithCorrelations.R (line  61, column 15)
R/annotateWithCorrelations.R (line  62, column 15)
R/annotateWithCorrelations.R (line  63, column 15)
R/annotateWithCorrelations.R (line  67, column 18)
R/annotateWithCorrelations.R (line  70, column 29)
R/annotateWithCorrelations.R (line  74, column 13)
R/annotateWithCorrelations.R (line  82, column 24)
R/annotateWithCorrelations.R (line  86, column 16)
R/annotateWithCorrelations.R (line  87, column 17)
R/annotateWithCorrelations.R (line  89, column 10)
R/annotateWithCorrelations.R (line  90, column 10)
R/annotateWithCorrelations.R (line  91, column 10)
R/annotateWithCorrelations.R (line  92, column 11)
R/annotateWithCorrelations.R (line  94, column  7)
R/annotateWithCorrelations.R (line  95, column  7)
R/annotateWithCorrelations.R (line  96, column  7)
R/annotateWithCorrelations.R (line  97, column  7)
R/annotateWithCorrelations.R (line  99, column 15)
R/annotateWithCorrelations.R (line 100, column 15)
R/annotateWithCorrelations.R (line 101, column 15)
R/annotateWithCorrelations.R (line 102, column 16)
R/annotateWithCorrelations.R (line 105, column 20)
R/annotateWithCorrelations.R (line 113, column 11)
R/annotateWithCorrelations.R (line 114, column 11)
R/annotateWithCorrelations.R (line 116, column 12)
R/annotateWithCorrelations.R (line 118, column 17)
R/annotateWithCorrelations.R (line 121, column  9)
R/annotateWithCorrelations.R (line 122, column  9)
R/annotateWithCorrelations.R (line 123, column 19)
R/annotateWithCorrelations.R (line 124, column 19)
R/annotateWithCorrelations.R (line 129, column 19)
R/annotateWithCorrelations.R (line 133, column 19)
R/annotateWithMarkers.R (line  38, column  5)
R/annotateWithMarkers.R (line  39, column  5)
R/annotateWithMarkers.R (line  40, column 15)
R/annotateWithMarkers.R (line  41, column 15)
R/annotateWithMarkers.R (line  42, column 15)
R/annotateWithMarkers.R (line  43, column 15)
R/annotateWithMarkers.R (line  45, column 14)
R/annotateWithMarkers.R (line  46, column 13)
R/annotateWithMarkers.R (line  50, column  7)
R/annotateWithMarkers.R (line  54, column  7)
R/annotateWithMarkers.R (line  57, column 12)
R/annotateWithMarkers.R (line  58, column 22)
R/annotateWithMarkers.R (line  61, column 13)
R/annotateWithMarkers.R (line  69, column 20)
R/annotateWithMarkers.R (line  74, column 10)
R/annotateWithMarkers.R (line  75, column 11)
R/annotateWithMarkers.R (line  76, column 11)
R/annotateWithMarkers.R (line  79, column 24)
R/annotateWithMarkers.R (line  80, column 22)
R/annotateWithMarkers.R (line  87, column 10)
R/annotateWithMarkers.R (line  88, column 10)
R/annotateWithMarkers.R (line  89, column 11)
R/annotateWithMarkers.R (line  91, column  7)
R/annotateWithMarkers.R (line  92, column  7)
R/annotateWithMarkers.R (line  93, column  7)
R/annotateWithMarkers.R (line  94, column  7)
R/annotateWithMarkers.R (line  96, column 15)
R/annotateWithMarkers.R (line  97, column 15)
R/annotateWithMarkers.R (line  98, column 16)
R/annotateWithMarkers.R (line 101, column 12)
R/annotateWithMarkers.R (line 108, column 11)
R/annotateWithMarkers.R (line 109, column 11)
R/annotateWithMarkers.R (line 111, column 12)
R/annotateWithMarkers.R (line 113, column 17)
R/annotateWithMarkers.R (line 116, column  9)
R/annotateWithMarkers.R (line 117, column  9)
R/annotateWithMarkers.R (line 118, column 19)
R/annotateWithMarkers.R (line 119, column 19)
R/annotateWithMarkers.R (line 124, column 19)
R/annotateWithMarkers.R (line 128, column 19)
R/decompose.R (line  96, column  5)
R/decompose.R (line  97, column 14)
R/decompose.R (line 100, column 14)
R/decompose.R (line 101, column 14)
R/decompose.R (line 102, column  5)
R/decompose.R (line 105, column  7)
R/decompose.R (line 106, column  7)
R/decompose.R (line 107, column  7)
R/decompose.R (line 108, column  7)
R/decompose.R (line 112, column 11)
R/decompose.R (line 127, column 10)
R/decompose.R (line 131, column  8)
R/decompose.R (line 137, column  8)
R/decompose.R (line 143, column 18)
R/decompose.R (line 144, column 18)
R/decompose.R (line 146, column 25)
R/decompose.R (line 147, column 25)
R/decompose.R (line 149, column 13)
R/decompose.R (line 152, column  4)
R/decompose.R (line 154, column 10)
R/decompose.R (line 155, column  7)
R/decompose.R (line 158, column  9)
R/decompose.R (line 170, column 20)
R/decompose.R (line 171, column 20)
R/decompose.R (line 184, column 11)
R/decompose.R (line 186, column 32)
R/decompose.R (line 189, column 11)
R/decompose.R (line 190, column 17)
R/decompose.R (line 195, column 10)
R/decompose.R (line 196, column 10)
R/decompose.R (line 197, column 10)
R/decompose.R (line 199, column 19)
R/decompose.R (line 200, column 19)
R/retrofit.R (line  49, column 14)
R/retrofit.R (line  56, column  7)
R/retrofit.R (line  62, column 15)
R/retrofit.R (line  66, column 34)
R/retrofit.R (line  69, column 15)
R/retrofit.R (line  73, column 29)
* NOTE:  Avoid the use of 'paste' in condition signals
Found in files:
R/annotateWithCorrelations.R (line 49, column 13)
R/annotateWithCorrelations.R (line 53, column 13)
R/annotateWithMarkers.R (line 49, column 13)
R/annotateWithMarkers.R (line 53, column 13)
* Checking parsed R code in R directory, examples, vignettes... OK
* Checking function lengths...
* NOTE: The recommended function length is 50 lines or less. There are 16 functions greater than 50 lines.
The longest 5 functions are:
decompose() (R/decompose.R): 162 lines
annotateWithCorrelations() (R/annotateWithCorrelations.R): 123 lines
annotateWithMarkers() (R/annotateWithMarkers.R): 119 lines
retrofit() (R/retrofit.R):  39 lines
plotfn() (vignettes/ColonVignette.Rmd):  26 lines
* Checking man page documentation... OK
* Checking package NEWS... OK
* Checking unit tests... OK
* Checking skip_on_bioc() in tests... OK
* Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
* NOTE: Consider shorter lines; 126 lines (8%) are > 80 characters long.
First few lines:
R/annotateWithCorrelations.R#L  3 #' @description Match cell types based o...
R/annotateWithCorrelations.R#L  5 #' @param sc_ref A Matrix or Array with ...
R/annotateWithCorrelations.R#L 49     warning(paste("cell_types(", length(...
R/annotateWithCorrelations.R#L 53     warning(paste("columns of decomp_w("...
R/annotateWithCorrelations.R#L 58   w = matrix(as.numeric(unlist(decomp_w)...
R/annotateWithCorrelations.R#L 59   h = matrix(as.numeric(unlist(decomp_h)...
R/annotateWithCorrelations.R#L 77     stop("the length of rowsums is 0. th...
R/annotateWithMarkers.R#L  3 #' @description Match cell types based o...
R/annotateWithMarkers.R#L  5 #' @param marker_ref Key-value list: A d...
R/annotateWithMarkers.R#L 38   w = matrix(as.numeric(unlist(decomp_w)...
R/annotateWithMarkers.R#L 39   h = matrix(as.numeric(unlist(decomp_h)...
R/annotateWithMarkers.R#L 49     warning(paste("cell_types(", length(...
R/annotateWithMarkers.R#L 53     warning(paste("columns of decomp_w("...
R/annotateWithMarkers.R#L 64     stop("the length of rowsums is 0. th...
R/data.R#L 31 #' A dataset with input and output of re...
R/decompose.R#L  5 #'  This function fulfills Structured St...
R/decompose.R#L  6 #'  Since exact Bayesian inference is in...
R/decompose.R#L  7 #'  variational inference was adopted to...
R/decompose.R#L  9 #' @param x matrix or array with dimensi...
R/decompose.R#L 10 #' @param L           integer (default:1...
R/decompose.R#L 11 #' @param iterations  integer (default:4...
R/decompose.R#L 12 #' @param lambda      double  (default:0...
R/decompose.R#L 69     stopifnot("alpha_w_0" %in% names(ini...
R/decompose.R#L 70     stopifnot("beta_w_0" %in% names(init...
R/decompose.R#L 71     stopifnot("alpha_h_0" %in% names(ini...
R/decompose.R#L 72     stopifnot("beta_h_0" %in% names(init...
R/decompose.R#L 73     stopifnot("alpha_th_0" %in% names(in...
R/decompose.R#L 74     stopifnot("beta_th_0" %in% names(ini...
R/decompose.R#L170     alpha_asterisk = decompose_step4_alp...
R/decompose.R#L171     beta_asterisk  = decompose_step4_bet...
R/decompose.R#L184         e = decompose_compute_error_mat_...
R/decompose.R#L189       dur = as.numeric(difftime(time1 = ...
R/decompose.R#L206     print(paste('Iteration mean: ', roun...
R/decompose.R#L207     result <- list(w=w_hat, h=h_hat, th=...
R/RcppExports.R#L 17     .Call(`_retrofit_decompose_compute_a...
R/RcppExports.R#L 21     .Call(`_retrofit_decompose_compute_a...
R/RcppExports.R#L 29     invisible(.Call(`_retrofit_decompose...
R/RcppExports.R#L 33     invisible(.Call(`_retrofit_decompose...
R/RcppExports.R#L 36 decompose_step4_alpha <- function(x_gs, ...
R/RcppExports.R#L 37     .Call(`_retrofit_decompose_step4_alp...
R/RcppExports.R#L 40 decompose_step4_beta <- function(distrib...
R/RcppExports.R#L 41     .Call(`_retrofit_decompose_step4_bet...
R/retrofit.R#L  4 #' @param x           A matrix or array ...
R/retrofit.R#L  5 #' @param sc_ref      A matrix or array ...
R/retrofit.R#L  6 #' @param marker_ref  A list with (keys,...
R/retrofit.R#L  7 #' @param L           integer (default:1...
R/retrofit.R#L  9 #' @param iterations  integer (default:4...
R/retrofit.R#L 11 #' @param lambda      double  (default:0...
man/annotateWithCorrelations.Rd#L 10 \item{sc_ref}{A Matrix or Array with two...
man/annotateWithCorrelations.Rd#L 28 Match cell types based on correlations w...
man/annotateWithMarkers.Rd#L 10 \item{marker_ref}{Key-value list: A dict...
man/annotateWithMarkers.Rd#L 26 Match cell types based on correlations w...
man/decompose.Rd#L 18 \item{x}{matrix or array with dimension ...
man/decompose.Rd#L 22 \item{iterations}{integer (default:4000)...
man/decompose.Rd#L 45 This function fulfills Structured Stocha...
man/decompose.Rd#L 46 Since exact Bayesian inference is infeas...
man/decompose.Rd#L 47 variational inference was adopted to app...
man/retrofit.Rd#L 22 \item{x}{A matrix or array with dimensio...
man/retrofit.Rd#L 24 \item{sc_ref}{A matrix or array with two...
man/retrofit.Rd#L 32 \item{iterations}{integer (default:4000)...
vignettes/ColonVignette.Rmd#L 13 # knitr::opts_chunk$set(echo = TRUE, res...
vignettes/ColonVignette.Rmd#L 19 RETROFIT is a statistical method for ref...
vignettes/ColonVignette.Rmd#L 37 First load the Colon ST data from fetal ...
vignettes/ColonVignette.Rmd#L 46 Initialize the required parameters for d...
vignettes/ColonVignette.Rmd#L 60 After deconvolution of ST data, we have ...
vignettes/ColonVignette.Rmd#L 73 Next, we need to annotate the components...
vignettes/ColonVignette.Rmd#L 77 Here, we will annotate components using ...
vignettes/ColonVignette.Rmd#L 83 This file contains average gene expressi...
vignettes/ColonVignette.Rmd#L 94 We assign components to the cell type it...
vignettes/ColonVignette.Rmd#L106                    col = colorRampPalett...
vignettes/ColonVignette.Rmd#L112 Here, we will annotate using known marke...
vignettes/ColonVignette.Rmd#L118 This file contains the list of marker ge...
vignettes/ColonVignette.Rmd#L134                    col=colorRampPalette(...
vignettes/ColonVignette.Rmd#L138 We assign components to the cell type it...
vignettes/ColonVignette.Rmd#L142 Hereon, we will be reproducing some of t...
vignettes/ColonVignette.Rmd#L155 img <- png::readPNG(RCurl::getURLContent...
vignettes/ColonVignette.Rmd#L156 t <- grid::rasterGrob(img, width=ggplot2...
vignettes/ColonVignette.Rmd#L157 # img <- png::readPNG(RCurl::getURLConte...
vignettes/ColonVignette.Rmd#L171 df$CellType=factor(df$CellType,levels=c(...
vignettes/ColonVignette.Rmd#L172                                         ...
vignettes/ColonVignette.Rmd#L176   ggplot2::scale_fill_manual(values=c("#...
vignettes/ColonVignette.Rmd#L178                     labels=c("Epithelial...
vignettes/ColonVignette.Rmd#L185                  axis.text.x = ggplot2::...
vignettes/ColonVignette.Rmd#L186                  axis.ticks.x = ggplot2:...
vignettes/ColonVignette.Rmd#L201                                  colors=...
vignettes/ColonVignette.Rmd#L202                                         ...
vignettes/ColonVignette.Rmd#L206   ggplot2::theme(legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L227                                  colors=...
vignettes/ColonVignette.Rmd#L228                                         ...
vignettes/ColonVignette.Rmd#L232   ggplot2::theme(legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L240         axis.text.x = ggplot2::element_b...
vignettes/ColonVignette.Rmd#L241         axis.ticks.x=ggplot2::element_bl...
vignettes/ColonVignette.Rmd#L243 Verify that the spatial pattern exhibite...
vignettes/ColonVignette.Rmd#L266     ggplot2::theme(legend.text = ggplot2...
vignettes/ColonVignette.Rmd#L302 Plot the proportion of only dominant cel...
vignettes/ColonVignette.Rmd#L311   6*(df_new$Endothelium>0.5) + 7*(df_new...
vignettes/ColonVignette.Rmd#L326   ggplot2::theme(legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L333         axis.text.x = ggplot2::element_b...
vignettes/ColonVignette.Rmd#L334         axis.ticks.x=ggplot2::element_bl...
vignettes/ColonVignette.Rmd#L345               df_new$Endothelium>0.25 | ...
vignettes/ColonVignette.Rmd#L352 df_new$CellType=factor(df_new$CellType,c...
vignettes/ColonVignette.Rmd#L369   ggplot2::theme(legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L375         axis.text.x = ggplot2::element_b...
vignettes/ColonVignette.Rmd#L376         axis.ticks.x=ggplot2::element_bl...
vignettes/ColonVignette.Rmd#L381 We found cell-type specific genes using ...
vignettes/ColonVignette.Rmd#L402 dat=data.frame(celltype=factor(c(rep("Ep...
vignettes/ColonVignette.Rmd#L403                                  rep("My...
vignettes/ColonVignette.Rmd#L404                                  rep("Pe...
vignettes/ColonVignette.Rmd#L406                                levels=c(...
vignettes/ColonVignette.Rmd#L407                                         ...
vignettes/ColonVignette.Rmd#L420   ggplot2::theme(axis.text.x = ggplot2::...
vignettes/SimulationVignette.Rmd#L 17 RETROFIT is a statistical method for ref...
vignettes/SimulationVignette.Rmd#L 40 The ST data matrix will consist of G = 5...
vignettes/SimulationVignette.Rmd#L 57 After deconvolution of ST data, we have ...
vignettes/SimulationVignette.Rmd#L 73 Next, we need to annotate the components...
vignettes/SimulationVignette.Rmd#L 80 This file contains average gene expressi...
vignettes/SimulationVignette.Rmd#L 93 We can also deconvolve the ST data matri...
vignettes/SimulationVignette.Rmd#L107 Visualize the correlation values between...
vignettes/SimulationVignette.Rmd#L110 correlations        = stats::cor(sc_ref_...
vignettes/SimulationVignette.Rmd#L118                                  label_c...
vignettes/SimulationVignette.Rmd#L127   ggplot2::geom_text(data=df, ggplot2::a...
vignettes/SimulationVignette.Rmd#L128   ggplot2::geom_text(data=df, ggplot2::a...
vignettes/SimulationVignette.Rmd#L131 All mapped cell types have greater than ...
vignettes/SimulationVignette.Rmd#L133 Since this is synthetic data, true cell ...
vignettes/SimulationVignette.Rmd#L142                      label = c(paste("RE...
vignettes/SimulationVignette.Rmd#L154 In case of real data, where ground truth...
* NOTE: Consider multiples of 4 spaces for line indents; 462 lines (30%) are not.
First few lines:
R/annotateWithCorrelations.R#L 23                                      K,...
R/annotateWithCorrelations.R#L 24                                      dec...
R/annotateWithCorrelations.R#L 25                                      dec...
R/annotateWithCorrelations.R#L 26   stopifnot(!is.null(sc_ref))...
R/annotateWithCorrelations.R#L 27   stopifnot((is.matrix(sc_ref) || is.arr...
R/annotateWithCorrelations.R#L 28   stopifnot(length(dim(sc_ref)) == 2)...
R/annotateWithCorrelations.R#L 29   stopifnot(!is.null(rownames(sc_ref)))...
R/annotateWithCorrelations.R#L 30   stopifnot(is.numeric(K))...
R/annotateWithCorrelations.R#L 31   stopifnot(!is.null(decomp_w))...
R/annotateWithCorrelations.R#L 32   stopifnot((is.matrix(decomp_w) || is.a...
R/annotateWithCorrelations.R#L 33   stopifnot(length(dim(decomp_w)) == 2)...
R/annotateWithCorrelations.R#L 34   # stopifnot(!is.null(rownames(decomp_w...
R/annotateWithCorrelations.R#L 35   stopifnot(!is.null(decomp_h))...
R/annotateWithCorrelations.R#L 36   stopifnot((is.matrix(decomp_h) || is.a...
R/annotateWithCorrelations.R#L 37   stopifnot(length(dim(decomp_h)) == 2)...
R/annotateWithCorrelations.R#L 38   # stopifnot(!is.null(rownames(decomp_h...
R/annotateWithCorrelations.R#L 39   stopifnot(dim(decomp_w)[2] == dim(deco...
R/annotateWithCorrelations.R#L 40   stopifnot(dim(decomp_w)[1] == dim(sc_r...
R/annotateWithCorrelations.R#L 41   ...
R/annotateWithCorrelations.R#L 42   cell_types = colnames(sc_ref)...
R/annotateWithCorrelations.R#L 43   ...
R/annotateWithCorrelations.R#L 44   if(is.null(cell_types)){...
R/annotateWithCorrelations.R#L 47   }...
R/annotateWithCorrelations.R#L 48   if(length(cell_types)<K){...
R/annotateWithCorrelations.R#L 51   }...
R/annotateWithCorrelations.R#L 52   if(dim(decomp_w)[2]<K){...
R/annotateWithCorrelations.R#L 55   }...
R/annotateWithCorrelations.R#L 56   ...
R/annotateWithCorrelations.R#L 57   # copy w, h to 'clear' colnames, rowna...
R/annotateWithCorrelations.R#L 58   w = matrix(as.numeric(unlist(decomp_w)...
R/annotateWithCorrelations.R#L 59   h = matrix(as.numeric(unlist(decomp_h)...
R/annotateWithCorrelations.R#L 60   rownames(w) = rownames(decomp_w)...
R/annotateWithCorrelations.R#L 61   colnames(w) = colnames(decomp_w)...
R/annotateWithCorrelations.R#L 62   rownames(h) = rownames(decomp_h)...
R/annotateWithCorrelations.R#L 63   colnames(h) = colnames(decomp_h)...
R/annotateWithCorrelations.R#L 64   ...
R/annotateWithCorrelations.R#L 65   # sc_ref_normalized = matrix(0, nrow=n...
R/annotateWithCorrelations.R#L 66   sc_ref_normalized <- sc_ref...
R/annotateWithCorrelations.R#L 67   sc_ref_rowsums = rowSums(sc_ref)...
R/annotateWithCorrelations.R#L 68   for (i in 1:length(sc_ref_rowsums)){...
R/annotateWithCorrelations.R#L 70       sc_ref_normalized[i,] = sc_ref[i,]...
R/annotateWithCorrelations.R#L 72   }...
R/annotateWithCorrelations.R#L 73   w_normalized <- w...
R/annotateWithCorrelations.R#L 74   w_rowsums = rowSums(w)...
R/annotateWithCorrelations.R#L 75   ...
R/annotateWithCorrelations.R#L 76   if(length(w_rowsums) == 0){...
R/annotateWithCorrelations.R#L 78   }...
R/annotateWithCorrelations.R#L 79   ...
R/annotateWithCorrelations.R#L 80   for (i in 1:length(w_rowsums)){...
R/annotateWithCorrelations.R#L 82       w_normalized[i,] = w[i,]/w_rowsums...
R/annotateWithCorrelations.R#L 84   }...
R/annotateWithCorrelations.R#L 85   ...
R/annotateWithCorrelations.R#L 86   correlations = stats::cor(sc_ref_norma...
R/annotateWithCorrelations.R#L 87   correlations2 = stats::cor(sc_ref_norm...
R/annotateWithCorrelations.R#L 88   ...
R/annotateWithCorrelations.R#L 89   col_sel=rep(NA,K)...
R/annotateWithCorrelations.R#L 90   row_sel=rep(NA,K)...
R/annotateWithCorrelations.R#L 91   cor_sel=rep(NA,K) ...
R/annotateWithCorrelations.R#L 92   cell_sel=rep(NA, K)...
R/annotateWithCorrelations.R#L 93   for(i in 1:K){...
R/annotateWithCorrelations.R#L105       correlations2=correlations2[-r1,-c...
R/annotateWithCorrelations.R#L107   }...
R/annotateWithCorrelations.R#L108   ...
R/annotateWithCorrelations.R#L109   # order selections following the refer...
R/annotateWithCorrelations.R#L110   sel <- data.frame(r=row_sel, c=col_sel...
R/annotateWithCorrelations.R#L111   sel <- sel[with(sel, order(r)),]...
R/annotateWithCorrelations.R#L112   ...
R/annotateWithCorrelations.R#L113   row_sel = sel$r...
R/annotateWithCorrelations.R#L114   col_sel = sel$c...
R/annotateWithCorrelations.R#L115   ...
R/annotateWithCorrelations.R#L116   cell_mod = rep(NA, K)...
R/annotateWithCorrelations.R#L117   for (i in 1:K) {...
R/annotateWithCorrelations.R#L119   }...
R/annotateWithCorrelations.R#L120   ...
R/annotateWithCorrelations.R#L121   w_mod = w[,col_sel]...
R/annotateWithCorrelations.R#L122   h_mod = h[col_sel,]...
R/annotateWithCorrelations.R#L123   colnames(w_mod) = cell_mod...
R/annotateWithCorrelations.R#L124   rownames(h_mod) = cell_mod...
R/annotateWithCorrelations.R#L125   ...
R/annotateWithCorrelations.R#L126   # weight to proportion...
R/annotateWithCorrelations.R#L127   w_mod_prop <- w_mod...
R/annotateWithCorrelations.R#L128   for(i in 1:nrow(w_mod)){...
R/annotateWithCorrelations.R#L130   }...
R/annotateWithCorrelations.R#L131   h_mod_prop <- h_mod...
R/annotateWithCorrelations.R#L132   for(i in 1:ncol(h_mod)){...
R/annotateWithCorrelations.R#L134   }...
R/annotateWithCorrelations.R#L135   ...
R/annotateWithCorrelations.R#L136   ret <- list(w=w_mod, ...
R/annotateWithCorrelations.R#L137               h=h_mod, ...
R/annotateWithCorrelations.R#L138               w_prop=w_mod_prop, ...
R/annotateWithCorrelations.R#L139               h_prop=h_mod_prop,...
R/annotateWithCorrelations.R#L140               ranked_cells=cell_sel, ...
R/annotateWithCorrelations.R#L141               ranked_correlations=cor_se...
R/annotateWithCorrelations.R#L142               sc_ref_prop=sc_ref_normali...
R/annotateWithCorrelations.R#L143   return(ret)...
R/annotateWithMarkers.R#L 24   stopifnot(!is.null(marker_ref))...
R/annotateWithMarkers.R#L 25   stopifnot(is.list(marker_ref))...
R/annotateWithMarkers.R#L 26   stopifnot(is.numeric(K))...
R/annotateWithMarkers.R#L 27   stopifnot(!is.null(decomp_w))...
R/annotateWithMarkers.R#L 28   stopifnot((is.matrix(decomp_w) || is.a...
R/annotateWithMarkers.R#L 29   stopifnot(length(dim(decomp_w)) == 2)...
R/annotateWithMarkers.R#L 30   # stopifnot(!is.null(rownames(decomp_w...
R/annotateWithMarkers.R#L 31   stopifnot(!is.null(decomp_h))...
R/annotateWithMarkers.R#L 32   stopifnot((is.matrix(decomp_h) || is.a...
R/annotateWithMarkers.R#L 33   stopifnot(length(dim(decomp_h)) == 2)...
R/annotateWithMarkers.R#L 34   # stopifnot(!is.null(rownames(decomp_h...
R/annotateWithMarkers.R#L 35   stopifnot(dim(decomp_w)[2] == dim(deco...
R/annotateWithMarkers.R#L 36   ...
R/annotateWithMarkers.R#L 37   # copy w, h to 'clear' colnames, rowna...
R/annotateWithMarkers.R#L 38   w = matrix(as.numeric(unlist(decomp_w)...
R/annotateWithMarkers.R#L 39   h = matrix(as.numeric(unlist(decomp_h)...
R/annotateWithMarkers.R#L 40   rownames(w) = rownames(decomp_w)...
R/annotateWithMarkers.R#L 41   colnames(w) = colnames(decomp_w)...
R/annotateWithMarkers.R#L 42   rownames(h) = rownames(decomp_h)...
R/annotateWithMarkers.R#L 43   colnames(h) = colnames(decomp_h)...
R/annotateWithMarkers.R#L 44   ...
R/annotateWithMarkers.R#L 45   cell_types = names(marker_ref)...
R/annotateWithMarkers.R#L 46   all_genes = unlist(marker_ref)...
R/annotateWithMarkers.R#L 47   ...
R/annotateWithMarkers.R#L 48   if(length(cell_types)<K){...
R/annotateWithMarkers.R#L 51   }...
R/annotateWithMarkers.R#L 52   if(dim(decomp_w)[2]<K){...
R/annotateWithMarkers.R#L 55   }...
R/annotateWithMarkers.R#L 56   ...
R/annotateWithMarkers.R#L 57   gene_sums=matrix(NA, nrow=length(cell_...
R/annotateWithMarkers.R#L 58   rownames(gene_sums)=cell_types...
R/annotateWithMarkers.R#L 59   ...
R/annotateWithMarkers.R#L 60   w_normed <- w[rownames(w) %in% all_gen...
R/annotateWithMarkers.R#L 61   w_rowsums = rowSums(w_normed)...
R/annotateWithMarkers.R#L 62   ...
R/annotateWithMarkers.R#L 63   if(length(w_rowsums) == 0){...
R/annotateWithMarkers.R#L 65   }...
R/annotateWithMarkers.R#L 66   ...
R/annotateWithMarkers.R#L 67   for (i in 1:length(w_rowsums)){...
R/annotateWithMarkers.R#L 69       w_normed[i,] = w_normed[i,]/w_rows...
R/annotateWithMarkers.R#L 71   }...
R/annotateWithMarkers.R#L 72   ...
R/annotateWithMarkers.R#L 73   for(r in 1:nrow(gene_sums)){...
R/annotateWithMarkers.R#L 79       w_matched_values = w_normed[rownam...
R/annotateWithMarkers.R#L 80       gene_sums[r,c] = sum(w_matched_val...
R/annotateWithMarkers.R#L 82   }...
R/annotateWithMarkers.R#L 83   ...
R/annotateWithMarkers.R#L 84   sums <- gene_sums...
R/annotateWithMarkers.R#L 85   sums2 <- gene_sums...
R/annotateWithMarkers.R#L 86   ...
R/annotateWithMarkers.R#L 87   col_sel=rep(NA,K)...
R/annotateWithMarkers.R#L 88   row_sel=rep(NA,K)...
R/annotateWithMarkers.R#L 89   cell_sel=rep(NA, K)...
R/annotateWithMarkers.R#L 90   for(i in 1:K){...
R/annotateWithMarkers.R#L101       sums2=sums2[-r1,-c1]...
R/annotateWithMarkers.R#L103   }...
R/annotateWithMarkers.R#L104   ...
R/annotateWithMarkers.R#L105   # order selections by row numbers...
R/annotateWithMarkers.R#L106   sel <- data.frame(r=row_sel,c=col_sel)...
R/annotateWithMarkers.R#L107   sel <- sel[with(sel, order(r)),]...
R/annotateWithMarkers.R#L108   row_sel = sel$r...
R/annotateWithMarkers.R#L109   col_sel = sel$c...
R/annotateWithMarkers.R#L110   ...
R/annotateWithMarkers.R#L111   cell_mod = rep(NA, K)...
R/annotateWithMarkers.R#L112   for (i in 1:K) {...
R/annotateWithMarkers.R#L114   }...
R/annotateWithMarkers.R#L115   ...
R/annotateWithMarkers.R#L116   w_mod = w[,col_sel]...
R/annotateWithMarkers.R#L117   h_mod = h[col_sel,]...
R/annotateWithMarkers.R#L118   colnames(w_mod) = cell_mod...
R/annotateWithMarkers.R#L119   rownames(h_mod) = cell_mod...
R/annotateWithMarkers.R#L120   ...
R/annotateWithMarkers.R#L121   # weight to proportion...
R/annotateWithMarkers.R#L122   w_mod_prop <- w_mod...
R/annotateWithMarkers.R#L123   for(i in 1:nrow(w_mod)){...
R/annotateWithMarkers.R#L125   }...
R/annotateWithMarkers.R#L126   h_mod_prop <- h_mod...
R/annotateWithMarkers.R#L127   for(i in 1:ncol(h_mod)){...
R/annotateWithMarkers.R#L129   }...
R/annotateWithMarkers.R#L130   ...
R/annotateWithMarkers.R#L131   ret <- list(w=w_mod, ...
R/annotateWithMarkers.R#L132               h=h_mod, ...
R/annotateWithMarkers.R#L133               w_prop=w_mod_prop, ...
R/annotateWithMarkers.R#L134               h_prop=h_mod_prop,...
R/annotateWithMarkers.R#L135               ranked_cells=cell_sel, ...
R/annotateWithMarkers.R#L136               gene_sums=sums)...
R/annotateWithMarkers.R#L137   return(ret)...
R/decompose.R#L 51                       L           = 16,...
R/decompose.R#L 52                       iterations  = 4000...
R/decompose.R#L 53                       init_param  = NULL...
R/decompose.R#L 54                       lambda      = 0.01...
R/decompose.R#L 55                       kappa       = 0.5,...
R/decompose.R#L 56                       verbose     = FALS...
R/decompose.R#L 57   stopifnot(!is.null(x))...
R/decompose.R#L 58   stopifnot((is.matrix(x) || is.array(x)...
R/decompose.R#L 59   stopifnot(length(dim(x)) == 2)...
R/decompose.R#L 60   stopifnot(!is.null(L))...
R/decompose.R#L 61   stopifnot(!is.null(lambda))...
R/decompose.R#L 62   stopifnot(!is.null(iterations))...
R/decompose.R#L 63   stopifnot(!is.null(kappa))...
R/decompose.R#L 64   stopifnot(is.numeric(L) && as.integer(...
R/decompose.R#L 65   stopifnot(is.numeric(iterations) && as...
R/decompose.R#L 66   stopifnot(is.numeric(kappa) && kappa >...
R/decompose.R#L 67   if(!is.null(init_param)){...
R/decompose.R#L 93   }...
R/decompose.R#L 94   ...
R/decompose.R#L 95   # change type....
R/decompose.R#L 96   L = as.integer(L)...
R/decompose.R#L 97   iterations = as.integer(iterations)...
R/decompose.R#L 98   ...
R/decompose.R#L 99   # copy and 'purify' the matrix...
R/decompose.R#L100   x_rownames = rownames(x)...
R/decompose.R#L101   x_colnames = colnames(x)...
R/decompose.R#L102   x = matrix(as.numeric(unlist(x)), nrow...
R/decompose.R#L103   ...
R/decompose.R#L104   # dimensions...
R/decompose.R#L105   G   = dim(x)[1] # Gene expressions...
R/decompose.R#L106   S   = dim(x)[2] # Spots...
R/decompose.R#L107   K   = L # alias the component number...
R/decompose.R#L108   dim = c(G,K,S)...
R/decompose.R#L109   ...
R/decompose.R#L110   # parameter vectors...
R/decompose.R#L111   if(is.null(init_param)){...
R/decompose.R#L113       alpha_w_0  = 0.05, ...
R/decompose.R#L114       beta_w_0   = 0.0001, ...
R/decompose.R#L115       alpha_h_0  = 0.2,...
R/decompose.R#L116       beta_h_0   = 0.2,...
R/decompose.R#L117       alpha_th_0 = 1.25,...
R/decompose.R#L118       beta_th_0  = 10,...
R/decompose.R#L119       alpha_th_k = array(stats::runif(K,...
R/decompose.R#L120       beta_th_k  = array(stats::runif(K,...
R/decompose.R#L121       alpha_w_gk = array(stats::runif(G*...
R/decompose.R#L122       beta_w_gk  = array(stats::runif(G*...
R/decompose.R#L123       alpha_h_ks = array(stats::runif(K*...
R/decompose.R#L124       beta_h_ks  = array(stats::runif(K*...
R/decompose.R#L126   } else {...
R/decompose.R#L128   }...
R/decompose.R#L129   ...
R/decompose.R#L130   # W/H/Th from Gamma dist...
R/decompose.R#L131   dist = list(...
R/decompose.R#L135   )...
R/decompose.R#L136   # probability variables...
R/decompose.R#L137   prob = list(...
R/decompose.R#L140   )...
R/decompose.R#L141   ...
R/decompose.R#L142   # variables for verbose mode...
R/decompose.R#L143   previous_param = list()...
R/decompose.R#L144   relative_error = list()...
R/decompose.R#L145   for (n in names(param)){...
R/decompose.R#L148   }...
R/decompose.R#L149   durations = NULL...
R/decompose.R#L150   ...
R/decompose.R#L151   ## start of algorithm...
R/decompose.R#L152   t=0...
R/decompose.R#L153   while(t<iterations){...
R/decompose.R#L182       # record error...
R/decompose.R#L183       for (name in names(param)){...
R/decompose.R#L187       }...
R/decompose.R#L188       # record performance...
R/decompose.R#L189       dur = as.numeric(difftime(time1 = ...
R/decompose.R#L190       durations = c(durations, dur)...
R/decompose.R#L191       print(paste('iteration:', t, paste...
R/decompose.R#L193   }...
R/decompose.R#L194   ...
R/decompose.R#L195   w_hat  = matrix(param$alpha_w_gk/param...
R/decompose.R#L196   h_hat  = matrix(param$alpha_h_ks/param...
R/decompose.R#L197   th_hat = matrix(param$alpha_th_k/param...
R/decompose.R#L198   ...
R/decompose.R#L199   rownames(w_hat) = x_rownames...
R/decompose.R#L200   colnames(h_hat) = x_colnames...
R/decompose.R#L201   ...
R/decompose.R#L202   if(!verbose){...
R/decompose.R#L204   } else {...
R/decompose.R#L208   }...
R/decompose.R#L209   ...
R/decompose.R#L210   return(result)...
R/retrofit.R#L 39                      sc_ref      = NULL,...
R/retrofit.R#L 40                      marker_ref   = NULL...
R/retrofit.R#L 41                      L           = 16,...
R/retrofit.R#L 42                      K           = 8,...
R/retrofit.R#L 43                      iterations  = 4000,...
R/retrofit.R#L 44                      init_param  = NULL,...
R/retrofit.R#L 45                      lambda      = 0.01,...
R/retrofit.R#L 46                      kappa       = 0.5,...
R/retrofit.R#L 47                      verbose     = FALSE...
R/retrofit.R#L 48   # Decompose...
R/retrofit.R#L 49   decomposed = decompose(x,...
R/retrofit.R#L 50                          L           = L...
R/retrofit.R#L 51                          iterations  = i...
R/retrofit.R#L 52                          init_param  = i...
R/retrofit.R#L 53                          lambda      = l...
R/retrofit.R#L 54                          kappa       = k...
R/retrofit.R#L 55                          verbose     = v...
R/retrofit.R#L 56   ret = list(...
R/retrofit.R#L 58   )...
R/retrofit.R#L 59   ...
R/retrofit.R#L 60   # Annotate...
R/retrofit.R#L 61   if(!is.null(sc_ref)){...
R/retrofit.R#L 63                                         ...
R/retrofit.R#L 64                                         ...
R/retrofit.R#L 65                                         ...
R/retrofit.R#L 67   }...
R/retrofit.R#L 68   if(!is.null(marker_ref)){...
R/retrofit.R#L 74   }...
R/retrofit.R#L 75   return(ret)...
man/decompose.Rd#L  8   x,...
man/decompose.Rd#L  9   L = 16,...
man/decompose.Rd#L 10   iterations = 4000,...
man/decompose.Rd#L 11   init_param = NULL,...
man/decompose.Rd#L 12   lambda = 0.01,...
man/decompose.Rd#L 13   kappa = 0.5,...
man/decompose.Rd#L 14   verbose = FALSE...
man/retrofit.Rd#L  9   x,...
man/retrofit.Rd#L 10   sc_ref = NULL,...
man/retrofit.Rd#L 11   marker_ref = NULL,...
man/retrofit.Rd#L 12   L = 16,...
man/retrofit.Rd#L 13   K = 8,...
man/retrofit.Rd#L 14   iterations = 4000,...
man/retrofit.Rd#L 15   init_param = NULL,...
man/retrofit.Rd#L 16   lambda = 0.01,...
man/retrofit.Rd#L 17   kappa = 0.5,...
man/retrofit.Rd#L 18   verbose = FALSE...
vignettes/ColonVignette.Rmd#L 94                    is.corr=FALSE, ...
vignettes/ColonVignette.Rmd#L 95                    mar=c(0,0,1,0), ...
vignettes/ColonVignette.Rmd#L 96                    col = colorRampPalett...
vignettes/ColonVignette.Rmd#L 97                    main="Correlation-bas...
vignettes/ColonVignette.Rmd#L122                    is.corr=FALSE, ...
vignettes/ColonVignette.Rmd#L123                    mar=c(0,0,1,0), ...
vignettes/ColonVignette.Rmd#L124                    col=colorRampPalette(...
vignettes/ColonVignette.Rmd#L125                    main="Marker-based Ma...
vignettes/ColonVignette.Rmd#L159   df$CellType[i]=names(which.max(df[i,-c...
vignettes/ColonVignette.Rmd#L165   ggplot2::geom_point(size=1.8, shape=21...
vignettes/ColonVignette.Rmd#L166   ggplot2::scale_fill_manual(values=c("#...
vignettes/ColonVignette.Rmd#L167                              "#0072B2", ...
vignettes/ColonVignette.Rmd#L169                              "Muscle","N...
vignettes/ColonVignette.Rmd#L170                              "Pericytes"...
vignettes/ColonVignette.Rmd#L171   ggplot2::xlab("") + ggplot2::ylab("") ...
vignettes/ColonVignette.Rmd#L172   ggplot2::theme(legend.position = "none...
vignettes/ColonVignette.Rmd#L173                  axis.line = ggplot2::el...
vignettes/ColonVignette.Rmd#L174                  plot.margin = ggplot2::...
vignettes/ColonVignette.Rmd#L175                  axis.text.x = ggplot2::...
vignettes/ColonVignette.Rmd#L176                  axis.ticks.x = ggplot2:...
vignettes/ColonVignette.Rmd#L188   # ggplot2::annotation_custom(t, 700, 6...
vignettes/ColonVignette.Rmd#L189   ggplot2::geom_point(size=1.5, ggplot2:...
vignettes/ColonVignette.Rmd#L190   ggplot2::scale_color_gradientn(name="E...
vignettes/ColonVignette.Rmd#L191                                  colors=...
vignettes/ColonVignette.Rmd#L193                                  n.break...
vignettes/ColonVignette.Rmd#L194   ggplot2::xlab("") + ggplot2::ylab("") ...
vignettes/ColonVignette.Rmd#L195   ggplot2::theme_classic()+...
vignettes/ColonVignette.Rmd#L196   ggplot2::theme(legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L197                  legend.key.width = ggpl...
vignettes/ColonVignette.Rmd#L198                  legend.title = ggplot2:...
vignettes/ColonVignette.Rmd#L199                  legend.position = "bott...
vignettes/ColonVignette.Rmd#L200                  legend.box.margin=ggplo...
vignettes/ColonVignette.Rmd#L201                  plot.margin = ggplot2::...
vignettes/ColonVignette.Rmd#L202                  axis.line=ggplot2::elem...
vignettes/ColonVignette.Rmd#L203                  legend.text=ggplot2::el...
vignettes/ColonVignette.Rmd#L204                  axis.text.x = ggplot2::...
vignettes/ColonVignette.Rmd#L205                  axis.text.y = ggplot2::...
vignettes/ColonVignette.Rmd#L206                  axis.ticks.x=ggplot2::e...
vignettes/ColonVignette.Rmd#L207                  axis.ticks.y=ggplot2::e...
vignettes/ColonVignette.Rmd#L214   # ggplot2::annotation_custom(t, 700, 6...
vignettes/ColonVignette.Rmd#L215   ggplot2::geom_point(size=1.5, ggplot2:...
vignettes/ColonVignette.Rmd#L216   ggplot2::scale_color_gradientn(name="E...
vignettes/ColonVignette.Rmd#L217                                  colors=...
vignettes/ColonVignette.Rmd#L219                                  n.break...
vignettes/ColonVignette.Rmd#L220   ggplot2::xlab("") + ggplot2::ylab("") ...
vignettes/ColonVignette.Rmd#L221   ggplot2::theme_classic()+...
vignettes/ColonVignette.Rmd#L222   ggplot2::theme(legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L243   #reshape to long format...
vignettes/ColonVignette.Rmd#L244   df$num <- 1:nrow(df)...
vignettes/ColonVignette.Rmd#L245   df1 <- reshape2::melt(df,id.vars = "nu...
vignettes/ColonVignette.Rmd#L246   #reversing order for cosmetic reasons...
vignettes/ColonVignette.Rmd#L247   df1 <- df1[rev(1:nrow(df1)),]...
vignettes/ColonVignette.Rmd#L248   ...
vignettes/ColonVignette.Rmd#L249   #plot...
vignettes/ColonVignette.Rmd#L250   p <- ggplot2::ggplot(df1, ggplot2::aes...
vignettes/ColonVignette.Rmd#L257           legend.key.size = ggplot2::uni...
vignettes/ColonVignette.Rmd#L258           legend.title = ggplot2::elemen...
vignettes/ColonVignette.Rmd#L259           axis.ticks = ggplot2::element_...
vignettes/ColonVignette.Rmd#L260           axis.text.x = ggplot2::element...
vignettes/ColonVignette.Rmd#L262                                "#009E73"...
vignettes/ColonVignette.Rmd#L263                                "#D55E00"...
vignettes/ColonVignette.Rmd#L264   ...
vignettes/ColonVignette.Rmd#L265   p...
vignettes/ColonVignette.Rmd#L285   ggplot2::theme(legend.position="bottom...
vignettes/ColonVignette.Rmd#L286   ggplot2::ggtitle("Fetal 19 PCW (C)")+ ...
vignettes/ColonVignette.Rmd#L287   ggplot2::theme(plot.title = ggplot2::e...
vignettes/ColonVignette.Rmd#L300   3*(df_new$Myo.Meso>0.5) + 4*(df_new$Mu...
vignettes/ColonVignette.Rmd#L301   6*(df_new$Endothelium>0.5) + 7*(df_new...
vignettes/ColonVignette.Rmd#L305   # ggplot2::annotation_custom(t, 700, 6...
vignettes/ColonVignette.Rmd#L306   ggplot2::geom_point(size=1.8, shape=21...
vignettes/ColonVignette.Rmd#L307   ggplot2::scale_fill_manual(values=c("#...
vignettes/ColonVignette.Rmd#L308                              "#009E73", ...
vignettes/ColonVignette.Rmd#L309                              "#D55E00", ...
vignettes/ColonVignette.Rmd#L311                              "Myofibrobl...
vignettes/ColonVignette.Rmd#L312                              "Muscle", "...
vignettes/ColonVignette.Rmd#L313                              "Pericytes"...
vignettes/ColonVignette.Rmd#L314   ggplot2::xlab("") + ggplot2::ylab("") ...
vignettes/ColonVignette.Rmd#L315   ggplot2::theme_classic()+...
vignettes/ColonVignette.Rmd#L316   ggplot2::theme(legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L335               df_new$Endothelium>0.25 | ...
vignettes/ColonVignette.Rmd#L336               df_new$Immune>0.25 | df_ne...
vignettes/ColonVignette.Rmd#L340   df_new$CellType[i]=names(which.max(df_...
vignettes/ColonVignette.Rmd#L343                                         ...
vignettes/ColonVignette.Rmd#L346   ggplot2::ylim(min(df$imagecol),max(df$...
vignettes/ColonVignette.Rmd#L347   ggplot2::xlim(min(df$imagerow),max(df$...
vignettes/ColonVignette.Rmd#L348   # ggplot2::annotation_custom(t, 700, 6...
vignettes/ColonVignette.Rmd#L349   ggplot2::geom_point(size=1.8, shape=21...
vignettes/ColonVignette.Rmd#L350   ggplot2::scale_fill_manual(values=c("#...
vignettes/ColonVignette.Rmd#L351                              "#009E73", ...
vignettes/ColonVignette.Rmd#L352                              "#D55E00", ...
vignettes/ColonVignette.Rmd#L354                              "Myofibrobl...
vignettes/ColonVignette.Rmd#L355                              "Muscle", "...
vignettes/ColonVignette.Rmd#L356                              "Pericytes"...
vignettes/ColonVignette.Rmd#L357   ggplot2::xlab("") + ggplot2::ylab("") ...
vignettes/ColonVignette.Rmd#L358   ggplot2::theme_classic()+...
vignettes/ColonVignette.Rmd#L359   ggplot2::theme(legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L393                                  rep("My...
vignettes/ColonVignette.Rmd#L394                                  rep("Pe...
vignettes/ColonVignette.Rmd#L395                                  rep("Im...
vignettes/ColonVignette.Rmd#L396                                levels=c(...
vignettes/ColonVignette.Rmd#L398                genes=factor(genes,levels...
vignettes/ColonVignette.Rmd#L399                val=c(df[,"Epithelial"],d...
vignettes/ColonVignette.Rmd#L400                      df[,"Myo.Meso"],df[...
vignettes/ColonVignette.Rmd#L401                      df[,"Pericytes"],df...
vignettes/ColonVignette.Rmd#L402                      df[,"Immune"],df[,"...
vignettes/ColonVignette.Rmd#L405   ggplot2::geom_tile() + ggplot2::theme_...
vignettes/ColonVignette.Rmd#L406   ggplot2::scale_fill_gradientn(colors =...
vignettes/ColonVignette.Rmd#L409   )+...
vignettes/ColonVignette.Rmd#L410   ggplot2::theme(axis.text.x = ggplot2::...
vignettes/ColonVignette.Rmd#L411                  legend.key.height = ggp...
vignettes/ColonVignette.Rmd#L412                  legend.key.width = ggpl...
vignettes/ColonVignette.Rmd#L413                  legend.title = ggplot2:...
vignettes/ColonVignette.Rmd#L414                  legend.justification="c...
vignettes/ColonVignette.Rmd#L415                  legend.box.margin=ggplo...
vignettes/ColonVignette.Rmd#L416                  legend.text=ggplot2::el...
vignettes/ColonVignette.Rmd#L417   ggplot2::xlab('')+ ggplot2::ylab('')+...
vignettes/ColonVignette.Rmd#L418   ggplot2::theme(legend.position="bottom...
vignettes/SimulationVignette.Rmd#L 75                                         ...
vignettes/SimulationVignette.Rmd#L 90                                  sc_ref=...
vignettes/SimulationVignette.Rmd#L 91                                  iterati...
vignettes/SimulationVignette.Rmd#L 92                                  L=L, ...
vignettes/SimulationVignette.Rmd#L 93                                  K=K)...
vignettes/SimulationVignette.Rmd#L104                                  y=ranke...
vignettes/SimulationVignette.Rmd#L105                                  label_x...
vignettes/SimulationVignette.Rmd#L106                                  label_x...
vignettes/SimulationVignette.Rmd#L107                                  label_y...
vignettes/SimulationVignette.Rmd#L108                                  label_c...
vignettes/SimulationVignette.Rmd#L109                                  label_c...
vignettes/SimulationVignette.Rmd#L112   ggplot2::geom_line(ggplot2::aes(x=x, y...
vignettes/SimulationVignette.Rmd#L113   ggplot2::geom_point(ggplot2::aes(x=x, ...
vignettes/SimulationVignette.Rmd#L114   ggplot2::theme_bw() + ...
vignettes/SimulationVignette.Rmd#L115   ggplot2::theme(axis.text.x=ggplot2::el...
vignettes/SimulationVignette.Rmd#L116   ggplot2::ylim(0, 1.05) +...
vignettes/SimulationVignette.Rmd#L117   ggplot2::ylab(expression(paste("Correl...
vignettes/SimulationVignette.Rmd#L118   ggplot2::geom_text(data=df, ggplot2::a...
vignettes/SimulationVignette.Rmd#L119   ggplot2::geom_text(data=df, ggplot2::a...
vignettes/SimulationVignette.Rmd#L130                      y=corrH)...
vignettes/SimulationVignette.Rmd#L132                      y=0.6,...
vignettes/SimulationVignette.Rmd#L133                      label = c(paste("RE...
vignettes/SimulationVignette.Rmd#L136   ggplot2::geom_line() + ...
vignettes/SimulationVignette.Rmd#L137   ggplot2::scale_color_manual('gray30') ...
vignettes/SimulationVignette.Rmd#L138   ggplot2::xlab("Normalized Rank") +...
vignettes/SimulationVignette.Rmd#L139   ggplot2::ylab(expression(paste("Correl...
vignettes/SimulationVignette.Rmd#L140   ggplot2::theme_bw() +...
vignettes/SimulationVignette.Rmd#L141   ggplot2::geom_text(data = df_text, ggp...
* Checking if package already exists in CRAN... OK
* Checking for bioc-devel mailing list subscription...
* NOTE: Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
* Checking for support site registration... OK
